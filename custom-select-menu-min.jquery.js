(function(a){a.fn.customSelectMenu=function(r){function q(b){var d=b.parent().attr("data-select-name"),l=b.attr("data-option-value"),j=b.text(),d=a('input[name="'+d+'"]');b.parent().find("."+c.selectedClass).removeClass(c.selectedClass);b.addClass(c.selectedClass);d.val(l);b.parent().parent().find("label").text(j);""!==d.val()?b.parent().parent().find("label").addClass(c.selectionMadeClass):b.parent().parent().find("label").removeClass(c.selectionMadeClass);b.parent().hide();b.parent().parent().find("label").toggleClass(c.openedClass)}
var c=a.extend({menuClass:"custom-select-menu",openedClass:"opened",selectedClass:"selected",selectionMadeClass:"selection-made"},r);return this.each(function(){var b=a(this),d=b.attr("name"),l=b.attr("id"),j="",f="",e="",k="",m="",n="",p="",g="";b.hide();k=a('<div class="'+c.menuClass+'">').attr("tabindex",0);l&&(k.attr("id",l),b.removeAttr("id"));m=a('<input type="hidden" name="'+d+'" value="" />');b.after(m);b.find(":selected")?(n=b.find(":selected"),p=n.attr("value"),f=n.text(),p?(e=a('<label class="'+
c.selectionMadeClass+'">'+f+"</label>"),m.val(p)):e=a("<label>"+f+"</label>")):(f=b.find(":first").text(),e=a("<label>"+f+"</label>"));e.on("click",function(){a("."+c.menuClass+" ul").not(a(this).parent().find("ul")).hide();a("."+c.menuClass+" ."+c.openedClass).not(a(this)).removeClass(c.openedClass);e.toggleClass(c.openedClass);e.parent().find("ul").toggle()});g=a('<ul data-select-name="'+d+'">').hide();b.after(k.append(e,g));b.find("option").each(function(){var b=a(this).text(),e=a(this).attr("value"),
d=b===f?' class="'+c.selectedClass+'"':"";j=e?a('<li data-option-value="'+e+'"'+d+">"+b+"</li>"):a("<li"+d+">"+b+"</li>");j.on("click",function(){q(a(this))});g.append(j)});k.on("keyup",function(b){if(38===b.keyCode||40===b.keyCode)a(this).find(e).addClass(c.openedClass),a(this).find(g).show();var d=a(this).find("li"),f=a(this).find("."+c.selectedClass),h="",h="";40===b.keyCode&&(f.removeClass(c.selectedClass),h=f.next(),0<h.length?h.addClass(c.selectedClass):d.first().addClass(c.selectedClass));
38===b.keyCode&&(f.removeClass(c.selectedClass),h=f.prev(),0<h.length?h.addClass(c.selectedClass):d.last().addClass(c.selectedClass));13===b.keyCode&&q(a(this).find("."+c.selectedClass))});a("html").on("keyup",function(a){27===a.keyCode&&(e.removeClass(c.openedClass),g.hide())});k.on("blur",function(){a(this).find(g).is(":visible")&&(a(this).find(e).removeClass(c.openedClass),a(this).find(g).hide())});a("html").on("mousedown",function(b){a(b.target).parents().addBack().is("."+c.menuClass+" ul, ."+
c.menuClass+" label")||(a("."+c.menuClass+" label").removeClass(c.openedClass),a("."+c.menuClass+" ul").hide())})})}})(jQuery);